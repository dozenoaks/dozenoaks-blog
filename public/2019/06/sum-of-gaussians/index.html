

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.55.6 with theme Tranquilpeak 0.4.3-BETA">
    <title>Plotting mixture models, part 2: sum of gaussians</title>
    <meta name="author" content="Ali Twelvetrees">
    <meta name="keywords" content="">

    <link rel="icon" href="/favicon.png">
    

    
    <meta name="description" content="In the previous post I plotted multiple fit gaussians onto a data set with ggplot2 - the final model is actually the sum of these fitted gaussians though, so how do I plot that? This is a more tricksy problem. I know I need to nest the mapply function inside another function, but my mind doesn’t immediately leap to the answer - I tried to come up with something quickly, but it inevitably failed.">
    <meta property="og:description" content="In the previous post I plotted multiple fit gaussians onto a data set with ggplot2 - the final model is actually the sum of these fitted gaussians though, so how do I plot that? This is a more tricksy problem. I know I need to nest the mapply function inside another function, but my mind doesn’t immediately leap to the answer - I tried to come up with something quickly, but it inevitably failed.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Plotting mixture models, part 2: sum of gaussians">
    <meta property="og:url" content="/2019/06/sum-of-gaussians/">
    <meta property="og:site_name" content="Dozenoaks Blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Dozenoaks Blog">
    <meta name="twitter:description" content="In the previous post I plotted multiple fit gaussians onto a data set with ggplot2 - the final model is actually the sum of these fitted gaussians though, so how do I plot that? This is a more tricksy problem. I know I need to nest the mapply function inside another function, but my mind doesn’t immediately leap to the answer - I tried to come up with something quickly, but it inevitably failed.">
    
      <meta name="twitter:creator" content="@dozenaoks">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/8c8109c71dcc98731581515d4d888fd2?s=640">
    

    
      <meta property="og:image" content="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/final-solution-1.png">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="/css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.css" />
    <link rel="stylesheet" href="/css/shades-of-purple.css" rel="stylesheet" id="theme-stylesheet">
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-11029994-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Dozenoaks Blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/8c8109c71dcc98731581515d4d888fd2?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Ali Twelvetrees</h4>
        
          <h5 class="sidebar-profile-bio">Research scientist looking at kinesin, dynein and neurons; trying to figure out how stuff moves around inside neurons and how it goes wrong in neurodegeneration.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.twelvetreeslab.co.uk">
    
      <i class="sidebar-button-icon fa fa-lg fa-flask"></i>
      
      <span class="sidebar-button-desc">Lab Website</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.twelvetreeslab.co.uk">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/dozenoaks">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Plotting mixture models, part 2: sum of gaussians
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2019-06-19T00:00:00Z">
        
  June 19, 2019

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/r">R</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              


<p>In the previous post I plotted multiple fit gaussians onto a data set with
ggplot2 - the final model is actually the sum of these fitted gaussians though,
so how do I plot that? This is a more tricksy problem. I know I need to nest
the <code>mapply</code> function inside another function, but my mind doesn’t immediately
leap to the answer - I tried to come up with something quickly, but it
inevitably failed.</p>
<p>My approach to fixing analysis problems like this is to break it down and build
up the complexity slowly until I get something that works. Rather than working
over the same code until it was right, this time I kept track of my iterations
so I had something I could use to demonstrate my approach to my students.</p>
<p><strong>An aside on why I think it’s important:</strong> I really want to create an
environment in my lab where folks are comfortable with coding (so far it’s
working!); I share <a href="https://quantixed.org/2019/06/13/coming-soon-the-digital-cell/">Steve Royle’s
view</a> that
“[computer-based methods] have now permeated mainstream […] cell biology to such
an extent that any groups that want to do cell biology in the future have to
adapt”. We’re wet lab scientists, and almost all my students coming in don’t
have huge experience in analyzing data with a programming language. I didn’t
learn R until I self-taught as a postdoc. One of the things that made it
difficult to learn was when you did figure out an answer with Google and stack
overflow, it was usually just presented to you - “Ta da! I’m smart look at my
solution!”. This gives the impression that if you know R/python/whatever you
should just know the answer - but really getting things to work requires the
same sort of focus and optimizing of a protocol as bench work. You can do it in
a structured way and with more experience you get better,
just like bench work. For me, part of fostering the right environment to
encourage people to pick up R and python and be comfortable not always getting
it right, is to show how I work through some problems.</p>
<div id="where-we-left-off" class="section level3">
<h3>where we left off</h3>
<p>I kick off where I left off, plotting the gaussians on a simulated data set</p>
<pre class="r"><code>#libraries needed
library(tidyverse)
library(mixtools)
library(ghibli) #&#39; if I want to look less professional by having 
                #&#39; studio ghibli themed plots on my blog that&#39;s my choice, okay?

#just a plotting theme
ggplot2::theme_set(
  theme_bw() +
    theme(
      plot.background = element_rect(fill = ghibli_palettes$PonyoLight[7]),
      panel.background = element_rect(fill = ghibli_palettes$PonyoLight[7]),
      plot.title = element_text(size = 14),
      axis.title = element_text(size = 14, colour = ghibli_palettes$PonyoDark[7]),
      axis.text = element_text(size = 12, colour = ghibli_palettes$PonyoDark[7]),
      panel.grid = element_blank()
    )
)

#simulate a dataset
set.seed(12) #better make this reproducible
observations &lt;- tibble(value = c(
  rnorm(n = 1000, mean = 0.1, sd = 0.1),
  rnorm(n = 4000, mean = 0.5, sd = 0.4),
  rnorm(n = 3000, mean = 0.9, sd = 0.1)
  )
  )

#model the dataset with multiple gaussians
my_mix &lt;- normalmixEM(observations$value, k = 3)</code></pre>
<pre><code>## number of iterations= 374</code></pre>
<pre class="r"><code>#plot the data and the model
ggplot(observations, aes(x = value)) + 
  geom_histogram(binwidth = 0.05, fill = ghibli_palettes$PonyoMedium[2]) +
  mapply(function(mean, sd, lambda, n, binwidth, colour) {
    stat_function(
      fun = function(x) {
        (dnorm(x, mean = mean, sd = sd)) * n * binwidth * lambda
        },
      colour = colour, #this is just to make it pretty
      size = 1
      ) 
    },
    mean = my_mix[[&quot;mu&quot;]], 
    sd = my_mix[[&quot;sigma&quot;]],
    lambda = my_mix[[&quot;lambda&quot;]],
    n = length(observations$value),
    binwidth = 0.05,
    colour = c(ghibli_palettes$PonyoMedium[3], 
               ghibli_palettes$PonyoMedium[4], 
               ghibli_palettes$PonyoMedium[5])
  )</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/set-up-1.png" width="672" /></p>
</div>
<div id="where-do-i-start" class="section level3">
<h3>where do I start?</h3>
<p><strong>[warning - this really does go at a snails pace, skip to the end if you want the finished function]</strong></p>
<p>Define the problem. I know what I want to do - at each point along x I want to
sum the individual guassians together to get the final model. I take this pretty
literally and start there. To make my life simpler while I focus on the problem,
I move out of plotting in <code>ggplot</code> for the time being and focus on the numbers.
The first thing I do is make the <code>dnorm</code> modification inside <code>mapply</code> into a
stand alone function so I can call it more easily.</p>
<pre class="r"><code>#my function
proportional_gauss &lt;- function(x, mean, sd, lambda, n, binwidth) {
        (dnorm(x, mean = mean, sd = sd)) * n * binwidth * lambda
        }</code></pre>
<pre class="r"><code>#generate a vector of x values to work with
x_values &lt;- seq(from = -1, to = 2, length.out = 1000)</code></pre>
<p>I’ll make a new vector which should be the y values at any given x value for the
first gaussian function from my model and then check it quickly:</p>
<pre class="r"><code>model_1 &lt;- proportional_gauss(
  x = x_values,
  mean = my_mix[[&quot;mu&quot;]][[1]],
  sd = my_mix[[&quot;sigma&quot;]][[1]],
  lambda = my_mix[[&quot;lambda&quot;]][[1]],
  n = length(observations$value),
  binwidth = 0.05
)

plot(model_1)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/first-model-1.png" width="672" /></p>
<p>Great - that worked. I’ll make the other two then assemble them all into one
table (<code>tibble</code>). With dplyr I’ll add a column with <code>mutate</code> to have the sum of
all the models, then quickly check if this give me the data I’m after.</p>
<pre class="r"><code>model_2 &lt;- proportional_gauss(
  x = x_values,
  mean = my_mix[[&quot;mu&quot;]][[2]],
  sd = my_mix[[&quot;sigma&quot;]][[2]],
  lambda = my_mix[[&quot;lambda&quot;]][[2]],
  n = length(observations$value),
  binwidth = 0.05
)

model_3 &lt;- proportional_gauss(
  x = x_values,
  mean = my_mix[[&quot;mu&quot;]][[3]],
  sd = my_mix[[&quot;sigma&quot;]][[3]],
  lambda = my_mix[[&quot;lambda&quot;]][[3]],
  n = length(observations$value),
  binwidth = 0.05
)

all_models &lt;- tibble(x_values = x_values,
                     first = model_1,
                     second = model_2,
                     third = model_3) %&gt;%
  mutate(., sum = sum(first, second, third))

plot(all_models$sum) #checking the product of the data</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/other-models-1.png" width="672" />
Eeeer nope… definitely not what I was hoping for. Using the <code>sum</code> function like this
has literally just summed the whole lot together, rather than at each x point.
Try again…</p>
<pre class="r"><code>#this time I&#39;ll manually add the columns together

all_models &lt;- tibble(
  x_values = x_values, 
  first = model_1, 
  second = model_2, 
  third = model_3) %&gt;% 
  mutate(., sum = (first + second + third))

plot(all_models$sum) #checking the product of the data</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/replace-sum-function-1.png" width="672" /></p>
<p>Okay - Better. Seems relatively simple. But I don’t want to manually call
each model, I want to have a function call all the relevant models at once. I
Google a bit and then read the <code>apply</code> help file for the thousandth time and try this:</p>
<pre class="r"><code>test_sum &lt;- apply(all_models[, 2:4], 1, sum) #row sums using apply across the 2nd to fourth columns
plot(test_sum)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/try-apply-1.png" width="672" /></p>
<p>Sweet! that totally worked. Okay, now do it in the table -</p>
<pre class="r"><code>#replacing the manual sum with the apply function
all_models &lt;- tibble(
  x_values = x_values,
  first = model_1,
  second = model_2,
  third = model_3) %&gt;%
  mutate(., sum = apply(all_models[, 2:4], 1, sum)) 

plot(all_models$sum)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/use-apply-in-tibble-1.png" width="672" /></p>
<p>Get in! okay, next task - change the absolute references to columns, <code>all_models[, 2:4]</code>, to relative ones with <code>ncol()</code>:</p>
<pre class="r"><code>#making the apply function in mutate generic
all_models &lt;- tibble(
  x_values = x_values,
  first = model_1,
  second = model_2,
  third = model_3) %&gt;%
  mutate(., sum = apply(.[, 2:ncol(.)], 1, sum))

plot(all_models$sum)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/make-apply-generic-1.png" width="672" /></p>
<pre class="r"><code>#It still works, and overlaying this manual data on the histrogram confirms it:
ggplot(observations, aes(x = value)) +
  geom_histogram(binwidth = 0.05, aes(y = ..count..), 
                 fill = ghibli_palettes$PonyoMedium[2]) +
  geom_line(data = all_models, aes(x = x_values, y = sum), 
            colour = ghibli_palettes$PonyoMedium[5], size = 1)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/make-apply-generic-2.png" width="672" /></p>
<p>Is it possible to nest the whole function inside ggplot or is that asking for
trouble? I can only try. First I’ll nest my <code>proportional_gauss</code> function inside
<code>mapply</code> pretty much the same as I did before when I was plotting.</p>
<pre class="r"><code>#this should do the same thing as before...
test &lt;- mapply(
  proportional_gauss, 
  x = x_values, 
  MoreArgs = list(
    mean = my_mix[[&quot;mu&quot;]],
    sd = my_mix[[&quot;sigma&quot;]],
    lambda = my_mix[[&quot;lambda&quot;]],
    n = length(observations$value),
    binwidth = 0.05
    )
  )</code></pre>
<p>When I use the function on the vector <code>x_values</code>, I can see the product <code>test</code>
becomes a matrix in my environment. The model data is along the row instead of down the
column. You can see this by using the row selector, <code>[row_number, column_number]</code>, to plot the data:</p>
<pre class="r"><code>#we&#39;ve got a matrix, so the data is along the row instead of down the column
plot(test[1,])</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/looking-at-the-matrix-1.png" width="672" /></p>
<p>So now I need to check that <code>apply</code> will still work and change the <code>MARGIN</code> command from 1 to 2:</p>
<pre class="r"><code>test2 &lt;- apply(test, 2, sum) #which means using apply with MARGIN set to 2 not 1 to sum across the guassians
plot(test2)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/trying-apply-again-1.png" width="672" /></p>
<pre class="r"><code>#And putting it all together...
test3 &lt;- apply(mapply(proportional_gauss,
    x = x_values,
    MoreArgs = list(
      mean = my_mix[[&quot;mu&quot;]],
      sd = my_mix[[&quot;sigma&quot;]],
      lambda = my_mix[[&quot;lambda&quot;]],
      n = length(observations$value),
      binwidth = 0.05
      )
    ),
  2, sum
  )
#I guess I should plot this one too, just to be sure...

plot(test3)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/trying-apply-again-2.png" width="672" /></p>
<p>Amazeballs! Happy with that. Okay, one last step; nest the <code>proportional_gauss()</code>
function inside a new <code>proportional_gauss_sum()</code> function, so I can use that inside
<code>stat_function()</code>. I’ll test it outside <code>ggplot</code> first:</p>
<pre class="r"><code>proportional_gauss_sum &lt;- function(x, mean, sd, lambda, n, binwidth) {
  apply(mapply(proportional_gauss,
                      x = x,
                      MoreArgs = list( mean, sd, lambda, n, binwidth)
                      ), 
               2, sum)
}

test4 &lt;- proportional_gauss_sum(
  x = x_values,
  mean = my_mix[[&quot;mu&quot;]],
  sd = my_mix[[&quot;sigma&quot;]],
  lambda = my_mix[[&quot;lambda&quot;]],
  n = length(observations$value),
  binwidth = 0.05
)

plot(test4)</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/proportional-gauss-sum-1.png" width="672" /></p>
<p>Okay - that means I’m ready for the final reveal. <strong>Ta da!</strong></p>
<pre class="r"><code>proportional_gauss &lt;- function(x, mean, sd, lambda, n, binwidth) {
        (dnorm(x, mean = mean, sd = sd)) * n * binwidth * lambda
}


proportional_gauss_sum &lt;- function(x, mean, sd, lambda, n, binwidth) {
  apply(mapply(proportional_gauss,
               x = x,
               MoreArgs = list( mean, sd, lambda, n, binwidth)
               ), 
        2, sum)
}

ggplot(observations, aes(x = value)) +
  geom_histogram(binwidth = 0.05, fill = ghibli_palettes$PonyoMedium[2]) +
  stat_function(
    fun = proportional_gauss_sum,
    args = list(
      mean = my_mix[[&quot;mu&quot;]],
      sd = my_mix[[&quot;sigma&quot;]],
      lambda = my_mix[[&quot;lambda&quot;]],
      n = length(observations$value),
      binwidth = 0.05
    ),
    colour = ghibli_palettes$PonyoMedium[5], size = 1
  )</code></pre>
<p><img src="/post/2019-06-19-plotting-mixture-models-part-2-sum-of-gaussians_files/figure-html/final-solution-1.png" width="672" /></p>
</div>
<div id="a-few-comments-on-the-process" class="section level3">
<h3>a few comments on the process</h3>
<p>Just as there’s more than one way to do a western blot, there’s more than one
way to work through a bump in analysis. Putting all the models into a
table/tibble in the begining was a bit of a wrong turn - it didn’t really help
get to the solution. I ended up there because I use dplyr a lot and it’s where
I’m comfortable. I do tend to plot a lot though, for me it’s the easiest way to
get a sense of the shape of the data and whether I’m on the right track. I’m
happy to make lot’s of incremental changes when I’m less familiar with
the functions I’m using - it’s easier to keep a handle on what’s going on.</p>
</div>
<div id="r-session" class="section level3">
<h3>R session</h3>
<pre class="r"><code>devtools::session_info()</code></pre>
<pre><code>## ─ Session info ──────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 3.6.0 (2019-04-26)
##  os       macOS Mojave 10.14          
##  system   x86_64, darwin15.6.0        
##  ui       X11                         
##  language (EN)                        
##  collate  en_GB.UTF-8                 
##  ctype    en_GB.UTF-8                 
##  tz       Europe/London               
##  date     2019-06-19                  
## 
## ─ Packages ──────────────────────────────────────────────────────────────
##  package     * version  date       lib source        
##  assertthat    0.2.1    2019-03-21 [1] CRAN (R 3.6.0)
##  backports     1.1.4    2019-04-10 [1] CRAN (R 3.6.0)
##  blogdown      0.13     2019-06-11 [1] CRAN (R 3.6.0)
##  bookdown      0.11     2019-05-28 [1] CRAN (R 3.6.0)
##  broom         0.5.2    2019-04-07 [1] CRAN (R 3.6.0)
##  callr         3.2.0    2019-03-15 [1] CRAN (R 3.6.0)
##  cellranger    1.1.0    2016-07-27 [1] CRAN (R 3.6.0)
##  cli           1.1.0    2019-03-19 [1] CRAN (R 3.6.0)
##  colorspace    1.4-1    2019-03-18 [1] CRAN (R 3.6.0)
##  crayon        1.3.4    2017-09-16 [1] CRAN (R 3.6.0)
##  desc          1.2.0    2018-05-01 [1] CRAN (R 3.6.0)
##  devtools      2.0.2    2019-04-08 [1] CRAN (R 3.6.0)
##  digest        0.6.19   2019-05-20 [1] CRAN (R 3.6.0)
##  dplyr       * 0.8.1    2019-05-14 [1] CRAN (R 3.6.0)
##  evaluate      0.14     2019-05-28 [1] CRAN (R 3.6.0)
##  forcats     * 0.4.0    2019-02-17 [1] CRAN (R 3.6.0)
##  fs            1.3.1    2019-05-06 [1] CRAN (R 3.6.0)
##  generics      0.0.2    2018-11-29 [1] CRAN (R 3.6.0)
##  ggplot2     * 3.1.1    2019-04-07 [1] CRAN (R 3.6.0)
##  ghibli      * 0.2.0    2019-03-21 [1] CRAN (R 3.6.0)
##  glue          1.3.1    2019-03-12 [1] CRAN (R 3.6.0)
##  gtable        0.3.0    2019-03-25 [1] CRAN (R 3.6.0)
##  haven         2.1.0    2019-02-19 [1] CRAN (R 3.6.0)
##  hms           0.4.2    2018-03-10 [1] CRAN (R 3.6.0)
##  htmltools     0.3.6    2017-04-28 [1] CRAN (R 3.6.0)
##  httr          1.4.0    2018-12-11 [1] CRAN (R 3.6.0)
##  jsonlite      1.6      2018-12-07 [1] CRAN (R 3.6.0)
##  knitr         1.23     2019-05-18 [1] CRAN (R 3.6.0)
##  labeling      0.3      2014-08-23 [1] CRAN (R 3.6.0)
##  lattice       0.20-38  2018-11-04 [1] CRAN (R 3.6.0)
##  lazyeval      0.2.2    2019-03-15 [1] CRAN (R 3.6.0)
##  lubridate     1.7.4    2018-04-11 [1] CRAN (R 3.6.0)
##  magrittr      1.5      2014-11-22 [1] CRAN (R 3.6.0)
##  MASS          7.3-51.4 2019-03-31 [1] CRAN (R 3.6.0)
##  Matrix        1.2-17   2019-03-22 [1] CRAN (R 3.6.0)
##  memoise       1.1.0    2017-04-21 [1] CRAN (R 3.6.0)
##  mixtools    * 1.1.0    2017-03-10 [1] CRAN (R 3.6.0)
##  modelr        0.1.4    2019-02-18 [1] CRAN (R 3.6.0)
##  munsell       0.5.0    2018-06-12 [1] CRAN (R 3.6.0)
##  nlme          3.1-140  2019-05-12 [1] CRAN (R 3.6.0)
##  pillar        1.4.1    2019-05-28 [1] CRAN (R 3.6.0)
##  pkgbuild      1.0.3    2019-03-20 [1] CRAN (R 3.6.0)
##  pkgconfig     2.0.2    2018-08-16 [1] CRAN (R 3.6.0)
##  pkgload       1.0.2    2018-10-29 [1] CRAN (R 3.6.0)
##  plyr          1.8.4    2016-06-08 [1] CRAN (R 3.6.0)
##  prettyunits   1.0.2    2015-07-13 [1] CRAN (R 3.6.0)
##  processx      3.3.1    2019-05-08 [1] CRAN (R 3.6.0)
##  ps            1.3.0    2018-12-21 [1] CRAN (R 3.6.0)
##  purrr       * 0.3.2    2019-03-15 [1] CRAN (R 3.6.0)
##  R6            2.4.0    2019-02-14 [1] CRAN (R 3.6.0)
##  Rcpp          1.0.1    2019-03-17 [1] CRAN (R 3.6.0)
##  readr       * 1.3.1    2018-12-21 [1] CRAN (R 3.6.0)
##  readxl        1.3.1    2019-03-13 [1] CRAN (R 3.6.0)
##  remotes       2.0.4    2019-04-10 [1] CRAN (R 3.6.0)
##  rlang         0.3.4    2019-04-07 [1] CRAN (R 3.6.0)
##  rmarkdown     1.13     2019-05-22 [1] CRAN (R 3.6.0)
##  rprojroot     1.3-2    2018-01-03 [1] CRAN (R 3.6.0)
##  rstudioapi    0.10     2019-03-19 [1] CRAN (R 3.6.0)
##  rvest         0.3.4    2019-05-15 [1] CRAN (R 3.6.0)
##  scales        1.0.0    2018-08-09 [1] CRAN (R 3.6.0)
##  segmented     0.5-4.0  2019-05-13 [1] CRAN (R 3.6.0)
##  sessioninfo   1.1.1    2018-11-05 [1] CRAN (R 3.6.0)
##  stringi       1.4.3    2019-03-12 [1] CRAN (R 3.6.0)
##  stringr     * 1.4.0    2019-02-10 [1] CRAN (R 3.6.0)
##  survival      2.44-1.1 2019-04-01 [1] CRAN (R 3.6.0)
##  tibble      * 2.1.3    2019-06-06 [1] CRAN (R 3.6.0)
##  tidyr       * 0.8.3    2019-03-01 [1] CRAN (R 3.6.0)
##  tidyselect    0.2.5    2018-10-11 [1] CRAN (R 3.6.0)
##  tidyverse   * 1.2.1    2017-11-14 [1] CRAN (R 3.6.0)
##  usethis       1.5.0    2019-04-07 [1] CRAN (R 3.6.0)
##  withr         2.1.2    2018-03-15 [1] CRAN (R 3.6.0)
##  xfun          0.7      2019-05-14 [1] CRAN (R 3.6.0)
##  xml2          1.2.0    2018-01-24 [1] CRAN (R 3.6.0)
##  yaml          2.2.0    2018-07-25 [1] CRAN (R 3.6.0)
## 
## [1] /Library/Frameworks/R.framework/Versions/3.6/Resources/library</code></pre>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/r/">R</a>

  <a class="tag tag--primary tag--small" href="/tags/ggplot2/">ggplot2</a>

  <a class="tag tag--primary tag--small" href="/tags/mixture-models/">mixture models</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2019/06/mixture-models/" data-tooltip="Plotting mixture models in ggplot2">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2019/06/sum-of-gaussians/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2019/06/sum-of-gaussians/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2019/06/sum-of-gaussians/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Ali Twelvetrees. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2019/06/mixture-models/" data-tooltip="Plotting mixture models in ggplot2">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2019/06/sum-of-gaussians/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2019/06/sum-of-gaussians/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2019/06/sum-of-gaussians/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2F2019%2F06%2Fsum-of-gaussians%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2F2019%2F06%2Fsum-of-gaussians%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2F2019%2F06%2Fsum-of-gaussians%2F">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/8c8109c71dcc98731581515d4d888fd2?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Ali Twelvetrees</h4>
    
      <div id="about-card-bio">Research scientist looking at kinesin, dynein and neurons; trying to figure out how stuff moves around inside neurons and how it goes wrong in neurodegeneration.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Vice Chancellor&rsquo;s Fellow
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Sheffield
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/06/sum-of-gaussians/">
                <h3 class="media-heading">Plotting mixture models, part 2: sum of gaussians</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In the previous post I plotted multiple fit gaussians onto a data set with ggplot2 - the final model is actually the sum of these fitted gaussians though, so how do I plot that? This is a more tricksy problem. I know I need to nest the mapply function inside another function, but my mind doesn’t immediately leap to the answer - I tried to come up with something quickly, but it inevitably failed.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/06/mixture-models/">
                <h3 class="media-heading">Plotting mixture models in ggplot2</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This post deals with something niche but practical - getting ggplot2 to plot multiple fitted gaussians from a model with different amplitudes. Google failed to provide the answer I was looking for - if you can’t find it with Google, it must need a blog post.
We have a couple of different projects running at the moment that need us to think about mixture models - these are common in single molecule biophysics work as you frequently end up with two or more populations of molecules stretched out along a continuous variable; could be velocity, step size or something else.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2018/03/moving-the-blog/">
                <h3 class="media-heading">Moving the blog</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Mar 3, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I moved my blog! Not just in terms of where it’s hosted, but how the whole thing is built. Previously I’d been using ghost, which was fine up until the moment I wanted to publish more code/analysis. The process of copy-pasting code and exporting images was taking more time than writing the code itself.
I’m now using the blogdown package which builds static websites within RStudio using Hugo and lets you publish the results.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2018/02/turning-a-kymograph-into-tidy-data-using-the-tidyverse-in-r/">
                <h3 class="media-heading">Turning a kymograph into tidy data using the tidyverse in R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I have a bit of a love hate relationship with kymographs. In the way that they compress data there’s no doubt that you loose information, but in the world of axonal transport and low signal:noise they have clear advantages in enabling quantification.
I covered before a couple of strategies you can use to import image data into R. The next step in my workflow is usually to turn that image into a data table for further analysis.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2017/12/kinesin-nomenclature/">
                <h3 class="media-heading">Kinesin nomenclature</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Andreas Prokop raised the issue of kinesin nomenclature on twitter over the weekend “I am tired of having to look up lists!”. I couldn’t agree more, it’s insanely confusing - especially when you’re trying to synthesise literature across several model organisms (shout out to Ustilago maydis and Dictyostelium discoideum here). Why is it confusing? The standardised kinesin nomenclature was defined in 2004, where the superfamily was divided into sub families.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2017/11/sci-twitter-like-a-pro/">
                <h3 class="media-heading">Sci twitter like a ‘pro&#39;</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I asked the scientists of twitter what platform they were using to interact with twitter itself (&lsquo;for a thing&rsquo;).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2016/09/importing-images-into-r/">
                <h3 class="media-heading">Importing images into R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2016
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In May my paper was finally released into the wild. Amongst other things it was the culmination of 4 years of me learning to use R for data analysis (and in my case data = images of cells). I’ve been meaning to blog some of this for a while, but I will try for my own sanity to keep everything in bite size chunks. Starting at the start: data import.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2015/06/the-pregnant-new-mum-guide-to-science-conferences/">
                <h3 class="media-heading">The pregnant/new mum guide to science conferences</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2015
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>Pregnancy and new motherhood has brought a whole swathe of new experiences to my conference outings. This is my definitive guide to science conferences for the expecting/new Mum to help you decide where to expend your energy&hellip;.</p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2014/12/merry-christmas/">
                <h3 class="media-heading">Merry Christmas!</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2014
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">When I was on the microscope imaging EB3 comets in axons as a control experiment for a control experiment, I got distracted by the comets in the dendrites - so pretty! They reminded me of the icicle lights on the outside of people&rsquo;s houses you see this time of year. So this is my science Christmas card to you - have a Merry one :)</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2014/01/drawing-microtubules/">
                <h3 class="media-heading">Drawing microtubules</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2014
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>Sometime ago I got recruited by Jake to help him come up with a summary figure for his paper on <a href="http://www.plosbiology.org/article/info:doi/10.1371/journal.pbio.1001611">p150 and microtubule catastrophe</a>. I place high scientific value on well designed descriptive schematics that help you visualise and explain the process your trying to describe, so I took the task on and decided to use it as an opportunity to build myself a decent microtubule model for later use.</p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         10 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/header.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  



    
  </body>
</html>

